<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Redirection‚Ä¶</title>

  <script>
    (function () {
      var path = window.location.pathname || "";
      var search = window.location.search || "";
      var hash = window.location.hash || "";

      // üö® 1. NE JAMAIS intercepter les liens d'authentification
      // (reset password, magic link, confirmation email, etc.)
      if (
        search.includes("access_token") ||
        hash.includes("access_token") ||
        search.includes("refresh_token") ||
        hash.includes("refresh_token") ||
        search.includes("type=recovery") ||
        search.includes("type=magiclink") ||
        path.startsWith("/reset-password") ||
        path.startsWith("/auth") ||
        path.startsWith("/callback")
      ) {
        return; // on laisse l'app / le navigateur g√©rer
      }

      // üö® 2. NE JAMAIS intercepter les fichiers syst√®me
      if (path.startsWith("/.well-known/")) {
        return;
      }

      // ‚úÖ 3. G√©rer les liens de parrainage /join/ABC123
      var joinMatch = path.match(/^\/join\/([^\/]+)\/?$/i);
      if (joinMatch && joinMatch[1]) {
        var code = joinMatch[1];
        window.location.replace(
          "/join/?ref=" + encodeURIComponent(code)
        );
        return;
      }

      // ‚úÖ 4. G√©rer les liens de groupe /group/xyz
      var groupMatch = path.match(/^\/group\/([^\/]+)\/?$/i);
      if (groupMatch && groupMatch[1]) {
        var groupId = groupMatch[1];
        window.location.replace(
          "/group/?id=" + encodeURIComponent(groupId)
        );
        return;
      }

      // üîÅ 5. Tout le reste ‚Üí accueil
      window.location.replace("/");
    })();
  </script>
</head>
<body></body>
</html>
